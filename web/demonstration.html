<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NaturaCode LLM Demonstration System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .panel h2 {
            margin-bottom: 20px;
            color: #444;
            font-size: 1.4rem;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: 600;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        .btn {
            padding: 14px 28px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-danger {
            background: #dc3545;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .status.loading {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .result-panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .result-panel h3 {
            margin-bottom: 15px;
            color: #444;
            font-size: 1.2rem;
        }

        .evaluation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .score-card {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .score-card .score {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .score-card .label {
            font-size: 0.9rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .score.excellent { color: #28a745; }
        .score.good { color: #17a2b8; }
        .score.fair { color: #ffc107; }
        .score.poor { color: #dc3545; }

        .code-display {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .comparison-table th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .issues-list {
            list-style: none;
            margin-top: 15px;
        }

        .issues-list li {
            padding: 8px 12px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }

        .tab-container {
            margin-top: 20px;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: #666;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }

            .results {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2rem;
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ NaturaCode LLM Demonstration</h1>
            <p>Automated testing and evaluation of natural language programming with multiple AI models</p>
        </div>

        <div class="dashboard">
            <!-- Controls Panel -->
            <div class="panel">
                <h2>‚öôÔ∏è Demonstration Controls</h2>
                
                <div class="controls">
                    <div class="form-group">
                        <label for="models">Select Models to Test:</label>
                        <div class="checkbox-group" id="models">
                            <!-- Models will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="categories">Categories to Test:</label>
                        <div class="checkbox-group" id="categories">
                            <!-- Categories will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="difficulty">Difficulty Level:</label>
                        <select id="difficulty">
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="customPrompt">Custom Prompt (Optional):</label>
                        <textarea id="customPrompt" rows="3" placeholder="Enter a custom prompt to override category-based prompts..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="createIssues" checked>
                            Automatically create GitHub issues for discovered features/bugs
                        </label>
                    </div>

                    <button class="btn" id="runDemo" onclick="runDemonstration()">
                        üöÄ Run Demonstration
                    </button>

                    <button class="btn btn-secondary" id="quickTest" onclick="showQuickTest()">
                        ‚ö° Quick Test
                    </button>
                </div>
            </div>

            <!-- Status Panel -->
            <div class="panel">
                <h2>üìä System Status</h2>
                <div id="status" class="status" style="display: none;"></div>
                
                <div class="stats-grid" id="statsGrid">
                    <!-- Statistics will be populated by JavaScript -->
                </div>

                <div id="progressContainer" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                    </div>
                    <div id="progressText" style="text-align: center; margin-top: 10px;"></div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="panel" id="resultsPanel" style="display: none;">
            <h2>üìà Demonstration Results</h2>
            
            <div class="tab-container">
                <div class="tabs">
                    <button class="tab active" onclick="showTab('summary')">Summary</button>
                    <button class="tab" onclick="showTab('evaluations')">Evaluations</button>
                    <button class="tab" onclick="showTab('comparison')">Comparison</button>
                    <button class="tab" onclick="showTab('feedback')">Feedback</button>
                    <button class="tab" onclick="showTab('issues')">GitHub Issues</button>
                </div>

                <div class="tab-content active" id="summary">
                    <div id="summaryContent"></div>
                </div>

                <div class="tab-content" id="evaluations">
                    <div id="evaluationsContent"></div>
                </div>

                <div class="tab-content" id="comparison">
                    <div id="comparisonContent"></div>
                </div>

                <div class="tab-content" id="feedback">
                    <div id="feedbackContent"></div>
                </div>

                <div class="tab-content" id="issues">
                    <div id="issuesContent"></div>
                </div>
            </div>
        </div>

        <!-- Quick Test Modal -->
        <div id="quickTestModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 12px; width: 90%; max-width: 600px;">
                <h3>‚ö° Quick Test</h3>
                <div class="form-group">
                    <label for="quickTestModel">Model:</label>
                    <select id="quickTestModel"></select>
                </div>
                <div class="form-group">
                    <label for="quickTestPrompt">Prompt:</label>
                    <textarea id="quickTestPrompt" rows="4" placeholder="Enter a prompt for the model..."></textarea>
                </div>
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn" onclick="runQuickTest()">Run Test</button>
                    <button class="btn btn-secondary" onclick="hideQuickTest()">Cancel</button>
                </div>
                <div id="quickTestResults" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>

    <script>
        let currentSession = null;
        let demoRunning = false;

        // Initialize the interface
        document.addEventListener('DOMContentLoaded', function() {
            loadAvailableModels();
            loadAvailableCategories();
            loadSystemStats();
        });

        async function loadAvailableModels() {
            try {
                const response = await fetch('/api/demo/models');
                const models = await response.json();
                
                const modelsContainer = document.getElementById('models');
                const quickTestModel = document.getElementById('quickTestModel');
                
                modelsContainer.innerHTML = '';
                quickTestModel.innerHTML = '';
                
                models.forEach(model => {
                    // Checkbox for main demo
                    const checkboxItem = document.createElement('div');
                    checkboxItem.className = 'checkbox-item';
                    checkboxItem.innerHTML = `
                        <input type="checkbox" id="model_${model.name}" value="${model.name}" ${model.provider === 'mock' ? 'checked' : ''}>
                        <label for="model_${model.name}">${model.name} (${model.provider})</label>
                    `;
                    modelsContainer.appendChild(checkboxItem);
                    
                    // Option for quick test
                    const option = document.createElement('option');
                    option.value = model.name;
                    option.textContent = `${model.name} (${model.provider})`;
                    quickTestModel.appendChild(option);
                });
            } catch (error) {
                console.error('Failed to load models:', error);
                showStatus('Error loading models: ' + error.message, 'error');
            }
        }

        async function loadAvailableCategories() {
            try {
                const response = await fetch('/api/demo/categories');
                const categories = await response.json();
                
                const categoriesContainer = document.getElementById('categories');
                categoriesContainer.innerHTML = '';
                
                categories.forEach((category, index) => {
                    const checkboxItem = document.createElement('div');
                    checkboxItem.className = 'checkbox-item';
                    checkboxItem.innerHTML = `
                        <input type="checkbox" id="category_${category.id}" value="${category.id}" ${index < 3 ? 'checked' : ''}>
                        <label for="category_${category.id}" title="${category.description}">${category.name}</label>
                    `;
                    categoriesContainer.appendChild(checkboxItem);
                });
            } catch (error) {
                console.error('Failed to load categories:', error);
                showStatus('Error loading categories: ' + error.message, 'error');
            }
        }

        async function loadSystemStats() {
            try {
                const response = await fetch('/api/demo/stats');
                const stats = await response.json();
                
                const statsGrid = document.getElementById('statsGrid');
                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-value">${stats.sessions.total}</div>
                        <div class="stat-label">Total Sessions</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.evaluations.total}</div>
                        <div class="stat-label">Evaluations</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.evaluations.averageScore}</div>
                        <div class="stat-label">Avg Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.feedback.issuesCreated}</div>
                        <div class="stat-label">Issues Created</div>
                    </div>
                `;
            } catch (error) {
                console.error('Failed to load stats:', error);
            }
        }

        async function runDemonstration() {
            if (demoRunning) return;
            
            const selectedModels = Array.from(document.querySelectorAll('#models input:checked')).map(cb => cb.value);
            const selectedCategories = Array.from(document.querySelectorAll('#categories input:checked')).map(cb => cb.value);
            const difficulty = document.getElementById('difficulty').value;
            const customPrompt = document.getElementById('customPrompt').value.trim();
            const createIssues = document.getElementById('createIssues').checked;
            
            if (selectedModels.length === 0) {
                showStatus('Please select at least one model', 'error');
                return;
            }
            
            if (selectedCategories.length === 0 && !customPrompt) {
                showStatus('Please select at least one category or provide a custom prompt', 'error');
                return;
            }
            
            demoRunning = true;
            document.getElementById('runDemo').disabled = true;
            showStatus('Starting demonstration...', 'loading');
            showProgress(0, 'Initializing...');
            
            try {
                const response = await fetch('/api/demo/run', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        models: selectedModels,
                        categories: selectedCategories,
                        difficulty: difficulty,
                        customPrompt: customPrompt || null,
                        createIssues: createIssues
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                currentSession = result;
                
                showStatus('Demonstration completed successfully!', 'success');
                hideProgress();
                displayResults(result);
                loadSystemStats(); // Refresh stats
                
            } catch (error) {
                console.error('Demonstration failed:', error);
                showStatus('Demonstration failed: ' + error.message, 'error');
                hideProgress();
            } finally {
                demoRunning = false;
                document.getElementById('runDemo').disabled = false;
            }
        }

        function showProgress(percentage, text) {
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            progressContainer.style.display = 'block';
            progressFill.style.width = percentage + '%';
            progressText.textContent = text;
        }

        function hideProgress() {
            document.getElementById('progressContainer').style.display = 'none';
        }

        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.style.display = 'block';
            status.className = `status ${type}`;
            status.textContent = message;
            
            if (type === 'success') {
                setTimeout(() => {
                    status.style.display = 'none';
                }, 5000);
            }
        }

        function displayResults(result) {
            document.getElementById('resultsPanel').style.display = 'block';
            
            // Display summary
            displaySummary(result.summary);
            
            // Display evaluations
            displayEvaluations(result.evaluations);
            
            // Display comparison
            displayComparison(result.comparison);
            
            // Display feedback
            displayFeedback(result.feedback);
            
            // Display GitHub issues
            displayGitHubIssues(result.createdIssues);
        }

        function displaySummary(summary) {
            const content = document.getElementById('summaryContent');
            content.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${summary.summary.newFeaturesDetected}</div>
                        <div class="stat-label">New Features</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${summary.summary.bugsDetected}</div>
                        <div class="stat-label">Bugs Found</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${summary.summary.issuesCreated}</div>
                        <div class="stat-label">Issues Created</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${summary.summary.improvementsIdentified}</div>
                        <div class="stat-label">Improvements</div>
                    </div>
                </div>
                
                <h3>üéØ Top Requested Features</h3>
                <ul class="issues-list">
                    ${summary.details.topRequestedFeatures.map(feature => 
                        `<li><strong>${feature.type}</strong> (${feature.count} requests)</li>`
                    ).join('')}
                </ul>
                
                <h3>üí° Recommendations</h3>
                <ul class="issues-list">
                    ${summary.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                </ul>
            `;
        }

        function displayEvaluations(evaluations) {
            const content = document.getElementById('evaluationsContent');
            content.innerHTML = evaluations.map(eval => `
                <div class="result-panel">
                    <h3>${eval.model} (${eval.provider})</h3>
                    
                    <div class="evaluation-grid">
                        <div class="score-card">
                            <div class="score ${getScoreClass(eval.evaluation.overall.score)}">${eval.evaluation.overall.score}</div>
                            <div class="label">Overall</div>
                        </div>
                        <div class="score-card">
                            <div class="score ${getScoreClass(eval.evaluation.results.syntax.score)}">${eval.evaluation.results.syntax.score}</div>
                            <div class="label">Syntax</div>
                        </div>
                        <div class="score-card">
                            <div class="score ${getScoreClass(eval.evaluation.results.logic.score)}">${eval.evaluation.results.logic.score}</div>
                            <div class="label">Logic</div>
                        </div>
                        <div class="score-card">
                            <div class="score ${getScoreClass(eval.evaluation.results.execution.score)}">${eval.evaluation.results.execution.score}</div>
                            <div class="label">Execution</div>
                        </div>
                        <div class="score-card">
                            <div class="score ${getScoreClass(eval.evaluation.results.readability.score)}">${eval.evaluation.results.readability.score}</div>
                            <div class="label">Readability</div>
                        </div>
                    </div>
                    
                    <h4>Generated Code:</h4>
                    <div class="code-display">${eval.evaluation.code}</div>
                    
                    ${eval.evaluation.overall.issues.length > 0 ? `
                        <h4>Issues Found:</h4>
                        <ul class="issues-list">
                            ${eval.evaluation.overall.issues.slice(0, 3).map(issue => `<li>${issue}</li>`).join('')}
                        </ul>
                    ` : ''}
                </div>
            `).join('');
        }

        function displayComparison(comparison) {
            const content = document.getElementById('comparisonContent');
            content.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${comparison.summary.averageScore}</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${comparison.summary.bestModel || 'N/A'}</div>
                        <div class="stat-label">Best Model</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${Object.entries(comparison.summary.gradeDistribution).find(([grade, count]) => count === Math.max(...Object.values(comparison.summary.gradeDistribution)))?.[0] || 'N/A'}</div>
                        <div class="stat-label">Most Common Grade</div>
                    </div>
                </div>
                
                <h3>üìä Category Performance</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Average Score</th>
                            <th>Best Model</th>
                            <th>Worst Model</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${Object.entries(comparison.categories).map(([category, data]) => `
                            <tr>
                                <td>${category}</td>
                                <td>${data.average}</td>
                                <td>${data.best || 'N/A'}</td>
                                <td>${data.worst || 'N/A'}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
                
                <h3>üîç Insights</h3>
                <ul class="issues-list">
                    ${comparison.insights.map(insight => `<li>${insight}</li>`).join('')}
                </ul>
            `;
        }

        function displayFeedback(feedback) {
            const content = document.getElementById('feedbackContent');
            content.innerHTML = `
                <h3>üÜï New Features Requested (${feedback.newFeatures.length})</h3>
                ${feedback.newFeatures.length > 0 ? `
                    <ul class="issues-list">
                        ${feedback.newFeatures.map(feature => `
                            <li>
                                <strong>${feature.feature.type}</strong> - ${feature.feature.description}
                                <br><small>Requested by: ${feature.model} | Priority: ${feature.priority}</small>
                            </li>
                        `).join('')}
                    </ul>
                ` : '<p>No new features requested.</p>'}
                
                <h3>üêõ Bugs Detected (${feedback.bugs.length})</h3>
                ${feedback.bugs.length > 0 ? `
                    <ul class="issues-list">
                        ${feedback.bugs.map(bug => `
                            <li>
                                ${bug.issue}
                                <br><small>Model: ${bug.model} | Severity: ${bug.severity}</small>
                            </li>
                        `).join('')}
                    </ul>
                ` : '<p>No bugs detected.</p>'}
                
                <h3>‚ö†Ô∏è Syntax Issues (${feedback.syntaxErrors.length})</h3>
                ${feedback.syntaxErrors.length > 0 ? `
                    <ul class="issues-list">
                        ${feedback.syntaxErrors.slice(0, 5).map(error => `
                            <li>
                                ${error.issue}
                                <br><small>Model: ${error.model}</small>
                            </li>
                        `).join('')}
                    </ul>
                ` : '<p>No syntax issues found.</p>'}
            `;
        }

        function displayGitHubIssues(issues) {
            const content = document.getElementById('issuesContent');
            content.innerHTML = `
                <h3>üìù GitHub Issues Created</h3>
                ${issues.length > 0 ? `
                    <ul class="issues-list">
                        ${issues.map(issue => `
                            <li>
                                ${issue.created ? '‚úÖ' : issue.exists ? 'üìù' : '‚ùå'} 
                                <strong>${issue.title}</strong>
                                ${issue.url ? `<br><a href="${issue.url}" target="_blank">${issue.url}</a>` : ''}
                                ${issue.error ? `<br><small style="color: red;">Error: ${issue.error}</small>` : ''}
                            </li>
                        `).join('')}
                    </ul>
                ` : '<p>No GitHub issues were created.</p>'}
            `;
        }

        function getScoreClass(score) {
            if (score >= 90) return 'excellent';
            if (score >= 80) return 'good';
            if (score >= 60) return 'fair';
            return 'poor';
        }

        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function showQuickTest() {
            document.getElementById('quickTestModal').style.display = 'block';
            document.getElementById('quickTestPrompt').value = 'Create a simple calculator that adds two numbers and shows the result';
        }

        function hideQuickTest() {
            document.getElementById('quickTestModal').style.display = 'none';
            document.getElementById('quickTestResults').innerHTML = '';
        }

        async function runQuickTest() {
            const model = document.getElementById('quickTestModel').value;
            const prompt = document.getElementById('quickTestPrompt').value.trim();
            
            if (!prompt) {
                alert('Please enter a prompt');
                return;
            }
            
            const resultsDiv = document.getElementById('quickTestResults');
            resultsDiv.innerHTML = '<div class="status loading">Running quick test...</div>';
            
            try {
                const response = await fetch('/api/demo/quick-test', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: model,
                        prompt: prompt
                    })
                });
                
                const result = await response.json();
                
                if (result.error) {
                    resultsDiv.innerHTML = `<div class="status error">Error: ${result.error}</div>`;
                } else {
                    resultsDiv.innerHTML = `
                        <div class="status success">Quick test completed!</div>
                        <h4>Generated Code:</h4>
                        <div class="code-display">${result.result.response}</div>
                        <h4>Evaluation Score: ${result.evaluation.overall.score}/100 (${result.evaluation.overall.grade})</h4>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status error">Failed to run quick test: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>